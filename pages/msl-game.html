<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MSL Study Lab & Games – SMCM MSL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="../assets/css/styles.css" />
  <link rel="icon" type="image/png" href="../assets/img/logo-1.png" />

  <!-- Page-specific layout tweaks -->
  <style>
    body.game-page {
      background: radial-gradient(circle at top, #111827, #020617);
      color: #f9fafb;
    }

    .game-page .section {
      padding-top: 3rem;
      padding-bottom: 3rem;
    }

    .game-page h1,
    .game-page h2,
    .game-page h3 {
      color: #f9fafb;
    }

    .game-layout {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    @media (min-width: 900px) {
      .game-layout {
        flex-direction: row;
        align-items: flex-start;
      }
      .game-layout-main {
        flex: 3;
      }
      .game-layout-side {
        flex: 2;
      }
    }

    .game-column {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .game-card-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
    }

    .game-card-title span.label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      opacity: 0.8;
    }

    .game-card-title span.label.study {
      color: #4ade80;
    }
    .game-card-title span.label.game {
      color: #60a5fa;
    }

    .game-page .card.plain-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.8);
    }

    .game-page .small,
    .game-page .section-body,
    .game-page p {
      color: #e5e7eb;
    }

    /* Canvas containers */
    .canvas-shell {
      background: #020617;
      border-radius: 0.75rem;
      padding: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
      text-align: center;
    }
    .canvas-shell canvas {
      background: #020617;
      display: block;
      margin: 0 auto;
      max-width: 100%;
      border-radius: 0.5rem;
    }

    .controls-text {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 0.35rem;
    }

    /* Quiz styles */
    #quiz-container {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    #quiz-question {
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    #quiz-options button {
      display: block;
      width: 100%;
      text-align: left;
      border-radius: 0.5rem;
      padding: 0.5rem 0.75rem;
      margin-bottom: 0.4rem;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      cursor: pointer;
      font-size: 0.9rem;
    }
    #quiz-options button:hover {
      background: rgba(37, 99, 235, 0.2);
    }
    #quiz-feedback {
      font-size: 0.85rem;
      min-height: 1.2em;
    }

    /* Hangman */
    #hangman-word {
      font-size: 1.25rem;
      letter-spacing: 0.25em;
      text-align: center;
      margin-bottom: 0.5rem;
    }
    #hangman-letters button {
      margin: 0.1rem;
      padding: 0.25rem 0.4rem;
      border-radius: 0.35rem;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      font-size: 0.75rem;
      cursor: pointer;
    }
    #hangman-letters button:disabled {
      opacity: 0.4;
      cursor: default;
    }
    #hangman-status {
      font-size: 0.85rem;
      margin-top: 0.4rem;
      text-align: center;
      min-height: 1.2em;
    }

    .bar-fill.energy {
      background: #22c55e;
    }
    .bar-fill.mood {
      background: #facc15;
    }
    .bar-fill.focus {
      background: #38bdf8;
    }

    .reaction-shell {
      border: 1px dashed rgba(148, 163, 184, 0.5);
      border-radius: 0.75rem;
      padding: 0.75rem;
      background: rgba(15, 23, 42, 0.45);
    }

    .reaction-controls {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin: 0.5rem 0;
    }

    /* YouTube embed ratio */
    .video-shell {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }
    .video-shell iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }
  </style>
</head>

<body class="game-page" data-page="games">
  <header class="site-header">
    <div class="inner">
      <a class="brand" data-nav-target="index.html#hero">
        <span class="brand-mark brand-mark-logo">
          <img src="../assets/img/logo-1.png" alt="SMCM MSL logo" />
        </span>
        <span class="brand-text">
          <span class="brand-title">MSL SMCM</span>
          <span class="brand-sub">Chapter</span>
        </span>
      </a>
      <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">☰</button>
      <nav class="nav" id="mainNav">
        <a class="nav-link" data-page="home" data-nav-target="index.html#hero">Home</a>
        <a class="nav-link" data-page="about" data-nav-target="index.html#maryland">About MSL</a>
        <a class="nav-link" data-page="chapter" data-nav-target="index.html#chapter">Our Chapter</a>
        <a class="nav-link" data-page="journey" data-nav-target="index.html#journey">Your Journey</a>
        <a class="nav-link" data-page="documents" data-nav-target="index.html#documents">Documents</a>
        <a class="nav-link" data-page="gallery" data-nav-target="index.html#gallery">Gallery</a>
        <a class="nav-link" data-page="join" data-nav-target="index.html#contact">Join Us</a>
        <a class="nav-link" data-page="bulletin" data-nav-target="pages/bulletin.html">Bulletin</a>
        <a class="nav-link" data-page="exec" data-nav-target="pages/executive-board.html">Exec Board</a>
        <a class="nav-link" data-page="resources" data-nav-target="pages/resources.html">Resources</a>
        <a class="nav-link" data-page="games" data-nav-target="pages/msl-game.html">Games</a>
        <a class="nav-link" data-page="neophytus" data-nav-target="pages/neophytus.html">Neophytus</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HEADER -->
    <section class="section">
      <div class="inner">
        <div class="section-header center">
          <p class="eyebrow">Practice, Play, Repeat</p>
          <h1>MSL Study Lab & Mini-Games</h1>
          <p class="section-body">
            Use this space to quiz yourself on legislative basics, watch a short explainer on how bills
            become law, and then unwind with low-stakes mini-games. Desktop is recommended for the games
            (keyboard controls), but the video and quiz work on mobile too.
          </p>
        </div>

        <div class="game-layout">
          <!-- LEFT: STUDY COLUMN -->
          <div class="game-layout-main game-column">
            <!-- Quiz -->
            <article class="card plain-card">
              <div class="game-card-title">
                <h2>MSL Quick Quiz</h2>
                <span class="label study">Study</span>
              </div>
              <p class="small">
                Short questions based on things you’ll see in MSL: committees, bills, chambers, and procedure.
                Great to run through before a meeting or session.
              </p>
              <div id="quiz-container">
                <div id="quiz-question"></div>
                <div id="quiz-options"></div>
                <div id="quiz-feedback" class="small"></div>
                <button id="quiz-next" class="btn btn-primary small" style="margin-top:0.5rem;">
                  Next Question
                </button>
                <p id="quiz-score" class="small" style="margin-top:0.5rem;"></p>
              </div>
            </article>

            <!-- CrashCourse video -->
            <article class="card plain-card">
              <div class="game-card-title">
                <h2>How a Bill Becomes Law (Crash Course)</h2>
                <span class="label study">Watch</span>
              </div>
              <p class="small">
                A quick visual run-through of committee, floor, and conference stages. Different level than MSL,
                same core logic of how ideas move through a legislature.
              </p>
              <div class="video-shell">
                <!-- Crash Course Government & Politics: How a Bill Becomes a Law -->
                <iframe
                  src="https://www.youtube.com/embed/66f4-NKEYz4"
                  title="How a Bill Becomes a Law – Crash Course Government and Politics"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen
                ></iframe>
              </div>
            </article>
          </div>

          <!-- RIGHT: GAMES COLUMN -->
          <div class="game-layout-side game-column">
            <!-- Snake -->
            <article class="card plain-card">
              <div class="game-card-title">
                <h2>Chamber Snake</h2>
                <span class="label game">Game</span>
              </div>
              <p class="small">
                Classic snake-style game. Collect “bills” (squares) and avoid running into yourself.
                <strong>Controls:</strong> W, A, S, D keys on desktop. On mobile, this one is better viewed than played.
              </p>
              <p class="small" style="opacity:0.8;">Difficulty: Steady pace—good for zoning out between study bursts.</p>
              <div class="canvas-shell">
                <canvas id="snakeCanvas" width="260" height="260"></canvas>
              </div>
              <p class="controls-text">
                Tip: Try to survive long enough to pass 10 “bills” in one run.
              </p>
            </article>

            <!-- Runner -->
            <article class="card plain-card">
              <div class="game-card-title">
                <h2>Floor Runner</h2>
                <span class="label game">Game</span>
              </div>
              <p class="small">
                Dodge procedural triangles, avoid gaps, and hit “boost blocks” to pick up speed.
                <strong>Controls:</strong> Spacebar or tap/click inside the game box to jump.
              </p>
              <p class="small" style="opacity:0.8;">Energy: Fast reflexes—best when you want a quick adrenaline spike.</p>
              <div class="canvas-shell">
                <canvas id="runnerCanvas" width="260" height="160"></canvas>
              </div>
              <p class="controls-text">
                Score = seconds survived. Make it to 5 minutes on a run to unlock the secret lab.
              </p>
              <p id="runner-best" class="small" style="margin-top:0.35rem;"></p>
              <div id="runner-leaderboard" class="small" style="margin-top:0.25rem;"></div>
            </article>

            <!-- Hangman -->
            <article class="card plain-card">
              <div class="game-card-title">
                <h2>Legislative Hangman</h2>
                <span class="label game">Game</span>
              </div>
              <p class="small">
                Guess MSL-related words before your attempts run out. All terms are drawn from things you’ll hear
                in meetings, bylaws, or statewide sessions.
              </p>
              <p class="small" style="opacity:0.8;">Vibe: Low-stress letters game for when you need a breather.</p>
              <div id="hangman-word">_ _ _ _</div>
              <div id="hangman-letters"></div>
              <div id="hangman-status" class="small"></div>
              <button id="hangman-reset" class="btn btn-primary small" style="margin-top:0.5rem;">
                New Word
              </button>
            </article>

            <!-- Reaction time game -->
            <article class="card plain-card">
              <div class="game-card-title">
                <h2>Gavel Reflex Drill</h2>
                <span class="label game">Game</span>
              </div>
              <p class="small">
                The presiding officer calls a vote—react as soon as you see “GO” to log a lightning-fast time.
                Click or press the space bar when the prompt appears.
              </p>
              <p class="small" style="opacity:0.8;">Mode: Quick-fire reflex test with honest feedback.</p>
              <div class="reaction-shell">
                <p id="reactionStatus" class="small">Press “Start round” to begin.</p>
                <div class="reaction-controls">
                  <button id="reactionStart" class="btn btn-primary small">Start round</button>
                  <button id="reactionTap" class="btn btn-ghost small" disabled>Tap when you see “GO”</button>
                </div>
                <p id="reactionResult" class="small"></p>
                <p id="reactionBest" class="small" style="opacity:0.75;"></p>
              </div>
            </article>

          </div>
        </div>
      </div>
    </section>

    <!-- SECRET UNLOCK SECTION -->
    <section class="section" id="secretSection" style="display:none;">
      <div class="inner">
        <article class="card plain-card">
          <h2>Secret Page Unlocked</h2>
          <p class="small">
            You (or someone on this device) survived a full 5 minutes in Floor Runner. That earns access
            to a hidden experiments page for future mini-games.
          </p>
          <p class="small">
            <a href="msl-secret.html" class="btn btn-primary small">Open Secret Lab (Coming Soon)</a>
          </p>
        </article>
      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div class="inner footer-inner">
      <p>© <span id="year"></span> Maryland Student Legislature – St. Mary’s College of Maryland Chapter.</p>
      <p class="small">
        Student-led, nonpartisan, and rooted in Maryland’s civic life. This site is maintained by the SMCM
        Maryland Student Legislature Chapter and is not an official publication of St. Mary’s College of
        Maryland or the State of Maryland.
      </p>
    </div>
  </footer>

  <script src="../assets/js/script.js"></script>

  <!-- Page-specific JS: all guarded so errors don't break the page -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      /* ---------- SECRET UNLOCK ---------- */
      const secretSection = document.getElementById("secretSection");
      function unlockSecret() {
        if (!secretSection) return;
        secretSection.style.display = "block";
        try {
          localStorage.setItem("mslSecretUnlocked", "true");
        } catch (e) {}
      }
      (function restoreSecret() {
        try {
          if (localStorage.getItem("mslSecretUnlocked") === "true" && secretSection) {
            secretSection.style.display = "block";
          }
        } catch (e) {}
      })();

      /* ---------- QUIZ ---------- */
      (function () {
        const questionEl = document.getElementById("quiz-question");
        const optionsEl = document.getElementById("quiz-options");
        const feedbackEl = document.getElementById("quiz-feedback");
        const nextBtn = document.getElementById("quiz-next");
        const scoreEl = document.getElementById("quiz-score");

        if (!questionEl || !optionsEl || !feedbackEl || !nextBtn || !scoreEl) return;

        const quiz = [
          {
            q: "In MSL, where does most detailed work on a bill happen first?",
            options: [
              "On the floor during final vote",
              "In committee hearings and markups",
              "In the governor’s office",
              "On social media"
            ],
            correct: 1
          },
          {
            q: "Which phrase best matches what a “sponsor” does?",
            options: [
              "Writes and introduces the bill",
              "Keeps time during speeches",
              "Runs the statewide organization",
              "Counts votes after the session"
            ],
            correct: 0
          },
          {
            q: "A motion to ‘table’ a bill usually means:",
            options: [
              "The bill passes immediately",
              "Debate continues with no speeches",
              "Consideration is paused or set aside",
              "The bill must be rewritten from scratch"
            ],
            correct: 2
          },
          {
            q: "What’s the main role of a committee chair?",
            options: [
              "To write every bill",
              "To enforce rules and manage discussion",
              "To record every vote by hand",
              "To campaign for statewide office"
            ],
            correct: 1
          },
          {
            q: "Why does MSL use parliamentary procedure?",
            options: [
              "To confuse new members",
              "To keep debate fair, orderly, and consistent",
              "Because it’s required by Maryland law",
              "So only officers can speak"
            ],
            correct: 1
          }
        ];

        let index = 0;
        let score = 0;
        let answered = false;

        function renderQuestion() {
          const current = quiz[index];
          answered = false;
          questionEl.textContent = current.q;
          feedbackEl.textContent = "";
          optionsEl.innerHTML = "";
          current.options.forEach((opt, i) => {
            const btn = document.createElement("button");
            btn.textContent = opt;
            btn.addEventListener("click", () => handleAnswer(i));
            optionsEl.appendChild(btn);
          });
          scoreEl.textContent = `Question ${index + 1} of ${quiz.length} · Score: ${score}`;
        }

        function handleAnswer(choice) {
          if (answered) return;
          answered = true;
          const current = quiz[index];
          if (choice === current.correct) {
            score++;
            feedbackEl.textContent = "Correct – you’d survive in committee.";
            feedbackEl.style.color = "#4ade80";
          } else {
            feedbackEl.textContent = "Not quite – check how we do it in MSL.";
            feedbackEl.style.color = "#f97373";
          }
          scoreEl.textContent = `Question ${index + 1} of ${quiz.length} · Score: ${score}`;
        }

        nextBtn.addEventListener("click", () => {
          index++;
          if (index >= quiz.length) {
            feedbackEl.textContent =
              score === quiz.length
                ? "Perfect run. Secret reward: you’re now unofficially ‘floor ready’."
                : "Nice work. Run it again later and see if you can get them all.";
            feedbackEl.style.color = "#facc15";
            index = 0;
            score = 0;
          }
          renderQuestion();
        });

        renderQuestion();
      })();

      /* ---------- SNAKE GAME (desktop-focused) ---------- */
      (function () {
        const canvas = document.getElementById("snakeCanvas");
        if (!canvas) return;
        const ctx = canvas.getContext("2d");

        const cols = 13;
        const rows = 13;
        const cellSize = Math.floor(canvas.width / cols);

        let snake, dir, food, alive;

        function resetSnake() {
          snake = [{ x: 6, y: 6 }];
          dir = { x: 0, y: -1 }; // up
          spawnFood();
          alive = true;
        }

        function spawnFood() {
          food = {
            x: Math.floor(Math.random() * cols),
            y: Math.floor(Math.random() * rows)
          };
          if (snake.some(seg => seg.x === food.x && seg.y === food.y)) {
            spawnFood();
          }
        }

        function step() {
          if (!alive) return;
          const head = snake[0];
          const next = { x: head.x + dir.x, y: head.y + dir.y };

          if (next.x < 0 || next.x >= cols || next.y < 0 || next.y >= rows) {
            alive = false;
            return;
          }

          if (snake.some(seg => seg.x === next.x && seg.y === next.y)) {
            alive = false;
            return;
          }

          snake.unshift(next);

          if (next.x === food.x && next.y === food.y) {
            spawnFood();
          } else {
            snake.pop();
          }
        }

        function draw() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "#020617";
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // food
          ctx.fillStyle = "#f97316";
          ctx.fillRect(
            food.x * cellSize + 2,
            food.y * cellSize + 2,
            cellSize - 4,
            cellSize - 4
          );

          // snake
          ctx.fillStyle = "#22c55e";
          snake.forEach(seg => {
            ctx.fillRect(
              seg.x * cellSize + 2,
              seg.y * cellSize + 2,
              cellSize - 4,
              cellSize - 4
            );
          });

          if (!alive) {
            ctx.fillStyle = "rgba(15,23,42,0.8)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#facc15";
            ctx.font = "14px sans-serif";
            ctx.textAlign = "center";
            ctx.fillText("Out of order – press R to restart", canvas.width / 2, canvas.height / 2);
          }
        }

        function gameLoop() {
          step();
          draw();
        }

        resetSnake();
        draw();
        setInterval(gameLoop, 150);

        window.addEventListener("keydown", (e) => {
          if (!canvas) return;

          const key = e.key.toLowerCase();

          if (key === "r") {
            resetSnake();
            return;
          }

          let nextDir = null;
          if (key === "w") nextDir = { x: 0, y: -1 };
          if (key === "s") nextDir = { x: 0, y: 1 };
          if (key === "a") nextDir = { x: -1, y: 0 };
          if (key === "d") nextDir = { x: 1, y: 0 };

          if (nextDir) {
            e.preventDefault();
            if (
              snake.length > 1 &&
              snake[0].x + nextDir.x === snake[1].x &&
              snake[0].y + nextDir.y === snake[1].y
            ) {
              return;
            }
            dir = nextDir;
          }
        });
      })();

      /* ---------- RUNNER GAME (with best score & leaderboard) ---------- */
      (function () {
        const canvas = document.getElementById("runnerCanvas");
        const bestScoreEl = document.getElementById("runner-best");
        const leaderboardEl = document.getElementById("runner-leaderboard");
        if (!canvas || !bestScoreEl || !leaderboardEl) return;
        const ctx = canvas.getContext("2d");

        const groundY = canvas.height - 30;
        let player, obstacles, boosts, gaps, speed, gravity, jumpVelocity, score, alive, startTime;

        let bestScore = 0;
        let leaderboard = [];
        const STORAGE_KEY = "mslRunnerLeaderboard";

        function loadLeaderboard() {
          try {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
              const parsed = JSON.parse(stored);
              bestScore = parsed.bestScore || 0;
              leaderboard = parsed.entries || [];
            }
          } catch (e) {}
        }

        function saveBestAndLeaderboard() {
          try {
            localStorage.setItem(
              STORAGE_KEY,
              JSON.stringify({ bestScore, entries: leaderboard })
            );
          } catch (e) {}
        }

        function renderLeaderboard() {
          bestScoreEl.textContent = `Best run on this device: ${Math.floor(bestScore)}s`;
          if (!leaderboard.length) {
            leaderboardEl.textContent =
              "Local leaderboard appears here after a 5-minute run. (Stored only on this device.)";
            return;
          }
          const lines = leaderboard.map((entry, idx) => {
            return `${idx + 1}. ${entry.tag} – ${Math.floor(entry.score)}s`;
          });
          leaderboardEl.textContent = "Local leaderboard: " + lines.join(" · ");
        }

        loadLeaderboard();
        renderLeaderboard();

        function resetRunner() {
          player = { x: 30, y: groundY, vy: 0, onGround: true };
          obstacles = [];
          boosts = [];
          gaps = [];
          speed = 3;
          gravity = 0.4;
          jumpVelocity = -7.5;
          score = 0;
          alive = true;
          startTime = Date.now();
        }

        function addObstacle() {
          const width = 12 + Math.random() * 10;
          obstacles.push({
            x: canvas.width + 20,
            y: groundY - 15,
            w: width,
            h: 15
          });
        }

        function addBoost() {
          boosts.push({
            x: canvas.width + 60,
            y: groundY - 35,
            size: 10,
            vy: -0.4
          });
        }

        function addGap() {
          const width = 40 + Math.random() * 40;
          gaps.push({
            x: canvas.width + 40,
            w: width
          });
        }

        let frameCount = 0;

        function handleGameOver() {
          const runTime = score; // seconds
          if (runTime > bestScore) {
            bestScore = runTime;
          }

          if (runTime >= 300) {
            // 5 minutes
            let initials = prompt(
              "You survived 5 minutes! Enter a 3-letter tag for the local leaderboard:",
              "MSL"
            );
            if (initials) {
              const tag = initials.toUpperCase().slice(0, 3);
              leaderboard.push({ tag, score: runTime, date: new Date().toISOString() });
              leaderboard.sort((a, b) => b.score - a.score);
              leaderboard = leaderboard.slice(0, 10);
              unlockSecret();
            }
          }

          saveBestAndLeaderboard();
          renderLeaderboard();
        }

        function endRun() {
          if (!alive) return;
          alive = false;
          handleGameOver();
        }

        function updateRunner() {
          if (!alive) return;

          frameCount++;
          const elapsedSec = (Date.now() - startTime) / 1000;
          score = elapsedSec;

          if (frameCount % 120 === 0) addObstacle();
          if (frameCount % 260 === 0) addBoost();
          if (frameCount % 200 === 0) addGap();

          // physics
          player.vy += gravity;
          player.y += player.vy;

          if (player.y >= groundY) {
            player.y = groundY;
            player.vy = 0;
            player.onGround = true;
          }

          // move obstacles
          obstacles.forEach(o => {
            o.x -= speed;
          });
          obstacles = obstacles.filter(o => o.x + o.w > -10);

          // move boosts
          boosts.forEach(b => {
            b.x -= speed * 0.9;
            b.y += b.vy;
          });
          boosts = boosts.filter(b => b.x + b.size > -10);

          // move gaps
          gaps.forEach(g => {
            g.x -= speed;
          });
          gaps = gaps.filter(g => g.x + g.w > -10);

          // obstacle collisions
          for (const o of obstacles) {
            const withinX = player.x + 12 > o.x && player.x - 8 < o.x + o.w;
            const withinY = player.y >= o.y && player.y <= o.y + o.h + 8;
            if (withinX && withinY) {
              endRun();
              return;
            }
          }

          // gap collisions (falling)
          for (const g of gaps) {
            if (player.x > g.x && player.x < g.x + g.w && player.y >= groundY) {
              endRun();
              return;
            }
          }

          // boosts
          boosts.forEach(b => {
            const dx = player.x - (b.x + b.size / 2);
            const dy = player.y - (b.y + b.size / 2);
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist < 20) {
              speed = 4.5;
              jumpVelocity = -9;
              setTimeout(() => {
                speed = 3;
                jumpVelocity = -7.5;
              }, 5000);
              b.x = -999;
            }
          });
        }

        function drawRunner() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);

          // background
          ctx.fillStyle = "#020617";
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // ground line
          ctx.strokeStyle = "#4b5563";
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(0, groundY + 8);
          ctx.lineTo(canvas.width, groundY + 8);
          ctx.stroke();

          // gaps (erase ground under them visually)
          ctx.fillStyle = "#020617";
          gaps.forEach(g => {
            ctx.fillRect(g.x, groundY + 1, g.w, canvas.height - groundY - 1);
          });

          // player
          ctx.fillStyle = "#38bdf8";
          ctx.fillRect(player.x - 8, player.y - 16, 16, 16);

          // obstacles (triangles)
          ctx.fillStyle = "#f97316";
          obstacles.forEach(o => {
            ctx.beginPath();
            ctx.moveTo(o.x, o.y + o.h);
            ctx.lineTo(o.x + o.w / 2, o.y);
            ctx.lineTo(o.x + o.w, o.y + o.h);
            ctx.closePath();
            ctx.fill();
          });

          // boosts (floating blocks)
          ctx.fillStyle = "#facc15";
          boosts.forEach(b => {
            ctx.fillRect(b.x, b.y, b.size, b.size);
          });

          // score
          ctx.fillStyle = "#e5e7eb";
          ctx.font = "12px sans-serif";
          ctx.textAlign = "left";
          ctx.fillText("Score: " + Math.floor(score) + "s", 8, 14);

          if (!alive) {
            ctx.fillStyle = "rgba(15,23,42,0.85)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#f97373";
            ctx.font = "13px sans-serif";
            ctx.textAlign = "center";
            ctx.fillText("You tripped on procedure.", canvas.width / 2, canvas.height / 2 - 8);
            ctx.fillStyle = "#facc15";
            ctx.fillText("Press R or tap to try again.", canvas.width / 2, canvas.height / 2 + 10);
          }
        }

        function runnerLoop() {
          updateRunner();
          drawRunner();
          requestAnimationFrame(runnerLoop);
        }

        function jump() {
          if (!alive) {
            resetRunner();
            return;
          }
          if (player.onGround) {
            player.vy = jumpVelocity;
            player.onGround = false;
          }
        }

        canvas.addEventListener("click", jump);
        canvas.addEventListener("touchstart", function (e) {
          e.preventDefault();
          jump();
        });

        window.addEventListener("keydown", (e) => {
          const key = e.key.toLowerCase();
          if (key === " " || key === "spacebar") {
            e.preventDefault();
            jump();
          }
          if (key === "r") {
            resetRunner();
          }
        });

        resetRunner();
        runnerLoop();
      })();

      /* ---------- HANGMAN ---------- */
      (function () {
        const wordEl = document.getElementById("hangman-word");
        const lettersEl = document.getElementById("hangman-letters");
        const statusEl = document.getElementById("hangman-status");
        const resetBtn = document.getElementById("hangman-reset");

        if (!wordEl || !lettersEl || !statusEl || !resetBtn) return;

        const words = [
          "BILL",
          "COMMITTEE",
          "QUORUM",
          "AMENDMENT",
          "CAUCUS",
          "RESOLUTION",
          "CHAMBER",
          "DRAFTING",
          "FLOOR",
          "GAVEL"
        ];

        let secret, revealed, attempts;

        function pickWord() {
          secret = words[Math.floor(Math.random() * words.length)];
          revealed = Array(secret.length).fill("_");
          attempts = 7;
          wordEl.textContent = revealed.join(" ");
          statusEl.textContent = "You have 7 attempts.";
          renderLetters();
        }

        function renderLetters() {
          lettersEl.innerHTML = "";
          const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
          for (const ch of alphabet) {
            const btn = document.createElement("button");
            btn.textContent = ch;
            btn.addEventListener("click", () => guessLetter(ch, btn));
            lettersEl.appendChild(btn);
          }
        }

        function guessLetter(ch, btn) {
          btn.disabled = true;
          let hit = false;
          for (let i = 0; i < secret.length; i++) {
            if (secret[i] === ch) {
              revealed[i] = ch;
              hit = true;
            }
          }
          wordEl.textContent = revealed.join(" ");

          if (!hit) {
            attempts--;
          }

          if (!revealed.includes("_")) {
            statusEl.textContent =
              "You nailed it. Reward: smug confidence next time someone uses that word incorrectly.";
            disableAll();
          } else if (attempts <= 0) {
            statusEl.textContent = `Out of attempts. The word was: ${secret}.`;
            disableAll();
          } else {
            statusEl.textContent = `Attempts left: ${attempts}`;
          }
        }

        function disableAll() {
          const buttons = lettersEl.querySelectorAll("button");
          buttons.forEach(b => (b.disabled = true));
        }

        resetBtn.addEventListener("click", pickWord);
        pickWord();
      })();

      /* ---------- REACTION GAME ---------- */
      (function () {
        const startBtn = document.getElementById("reactionStart");
        const tapBtn = document.getElementById("reactionTap");
        const statusEl = document.getElementById("reactionStatus");
        const resultEl = document.getElementById("reactionResult");
        const bestEl = document.getElementById("reactionBest");
        if (!startBtn || !tapBtn || !statusEl || !resultEl || !bestEl) return;

        let waitingForGo = false;
        let liveRound = false;
        let startTime = 0;
        let timeoutId = null;
        let best = null;

        function labelForReaction(ms) {
          if (ms < 200) return "Elite reflex";
          if (ms < 280) return "Fast";
          if (ms < 360) return "Solid";
          if (ms < 450) return "Warming up";
          return "Keep practicing";
        }

        function scheduleRound() {
          clearTimeout(timeoutId);
          tapBtn.disabled = true;
          liveRound = false;
          waitingForGo = true;
          statusEl.textContent = "Hold steady… wait for GO.";
          resultEl.textContent = "";
          timeoutId = setTimeout(triggerGo, 1200 + Math.random() * 2200);
        }

        function triggerGo() {
          waitingForGo = false;
          liveRound = true;
          tapBtn.disabled = false;
          tapBtn.focus();
          statusEl.textContent = "GO! Tap now.";
          startTime = performance.now();
        }

        function endRound(message) {
          statusEl.textContent = message;
          tapBtn.disabled = true;
          liveRound = false;
        }

        startBtn.addEventListener("click", () => {
          scheduleRound();
        });

        tapBtn.addEventListener("click", () => {
          if (waitingForGo) {
            endRound("Too soon. Resetting the round.");
            clearTimeout(timeoutId);
            setTimeout(scheduleRound, 600);
            return;
          }

          if (!liveRound) return;
          const reaction = Math.round(performance.now() - startTime);
          resultEl.textContent = `Reaction time: ${reaction} ms (${labelForReaction(reaction)})`;
          if (best === null || reaction < best) {
            best = reaction;
            bestEl.textContent = `Personal best: ${best} ms`;
          }
          endRound("Nice reflexes. Start another round when ready.");
        });

        document.addEventListener("keydown", (event) => {
          if ((event.code === "Space" || event.key === " ") && !tapBtn.disabled) {
            event.preventDefault();
            tapBtn.click();
          }
        });

        bestEl.textContent = "Personal best: —";
      })();


    });
  </script>
</body>
</html>
