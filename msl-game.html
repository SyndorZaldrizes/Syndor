<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MSL Games ‚Äì SMCM MSL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" type="image/png" href="logo-1.png" />

  <!-- Mini-game specific styles -->
  <style>
    /* Page background: soft starfield / space vibes */
    .games-page {
      min-height: 100vh;
      background-color: #020617;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(248, 250, 252, 0.25), transparent 55%),
        radial-gradient(circle at 80% 10%, rgba(248, 250, 252, 0.18), transparent 50%),
        radial-gradient(circle at 60% 70%, rgba(59, 130, 246, 0.25), transparent 55%),
        linear-gradient(to bottom, #0f172a 0, #020617 45%, #000 100%);
      background-attachment: fixed;
      color: #e5e7eb;
    }

    .games-page main {
      padding-bottom: 4rem;
    }

    .game-wrapper {
      max-width: 900px;
      margin: 0 auto;
    }

    .game-card {
      margin-top: 1.5rem;
      padding: 1.5rem 1.75rem;
      border-radius: 16px;
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.6);
      backdrop-filter: blur(4px);
      cursor: default;
    }

    .game-card a {
      color: #facc15;
      text-decoration: underline;
    }

    .game-card a:hover {
      text-decoration: none;
    }

    .game-meta {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-size: 0.85rem;
      opacity: 0.9;
      margin-bottom: 0.4rem;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .game-question {
      font-size: 1.15rem;
      font-weight: 600;
      margin: 0.4rem 0 1rem;
    }

    .game-choices {
      display: grid;
      gap: 0.6rem;
      margin-bottom: 1rem;
    }

    .game-choice-btn {
      width: 100%;
      text-align: left;
      padding: 0.65rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.15s ease, border-color 0.15s ease, transform 0.08s ease;
    }

    .game-choice-btn:hover {
      transform: translateY(-1px);
      border-color: #facc15;
      background: rgba(30, 64, 175, 0.9);
    }

    .game-choice-btn.correct {
      background: #16a34a;
      border-color: #bbf7d0;
      color: #022c22;
    }

    .game-choice-btn.incorrect {
      background: #b91c1c;
      border-color: #fecaca;
      color: #fef2f2;
    }

    .game-feedback {
      font-size: 0.9rem;
      margin-bottom: 0.8rem;
    }

    .game-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .game-progress {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    .btn-ghost-small {
      border-radius: 999px;
      padding: 0.45rem 0.9rem;
      font-size: 0.85rem;
    }

    .game-result-card {
      margin-top: 1.5rem;
      padding: 1.5rem 1.75rem;
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.98);
      color: #f9fafb;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.65);
    }

    .game-result-score {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 0.35rem;
    }

    .game-result-sub {
      font-size: 0.9rem;
      margin-bottom: 0.6rem;
    }

    .game-tagline {
      font-size: 0.85rem;
      opacity: 0.95;
    }

    .game-easter-egg {
      margin-top: 0.9rem;
      padding: 0.9rem 1rem;
      border-radius: 12px;
      border: 1px dashed rgba(234, 179, 8, 0.9);
      background: rgba(250, 204, 21, 0.08);
      font-size: 0.9rem;
    }

    .game-easter-egg a {
      text-decoration: underline;
      font-weight: 600;
    }

    /* Bill Concept Lab styles */
    .bill-lab-form {
      display: grid;
      gap: 0.9rem;
      margin-top: 0.75rem;
    }

    .bill-lab-form label {
      font-size: 0.9rem;
      font-weight: 500;
      display: block;
    }

    .bill-lab-form select,
    .bill-lab-form input,
    .bill-lab-form textarea {
      width: 100%;
      margin-top: 0.25rem;
      padding: 0.5rem 0.6rem;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      font-size: 0.9rem;
      font-family: inherit;
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
    }

    .bill-lab-form textarea::placeholder {
      color: rgba(148, 163, 184, 0.8);
    }

    .bill-lab-output {
      margin-top: 1.1rem;
      padding: 1rem 1.1rem;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: #f9fafb;
      font-size: 0.92rem;
      white-space: pre-line;
    }

    .bill-lab-output h3 {
      margin-top: 0;
      margin-bottom: 0.3rem;
      font-size: 1rem;
      font-weight: 700;
    }

    .bill-lab-meta {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-bottom: 0.5rem;
    }

    /* Arcade games */
    #snakeCanvas,
    #runnerCanvas {
      width: 100%;
      max-width: 400px;
      display: block;
      margin: 0.5rem auto 0.75rem;
      background: #020617;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.9);
    }

    .arcade-note {
      font-size: 0.85rem;
      opacity: 0.95;
      margin-bottom: 0.5rem;
    }

    /* Pet / Field Companion widget */
    .field-companion-widget {
      position: fixed;
      right: 1rem;
      bottom: 1rem;
      z-index: 50;
      font-size: 0.85rem;
    }

    .field-companion-toggle {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.98);
      color: #e5e7eb;
      padding: 0.4rem 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.6);
    }

    .field-companion-toggle span {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .field-companion-panel {
      margin-top: 0.5rem;
      padding: 0.75rem 0.9rem;
      border-radius: 14px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(148, 163, 184, 0.9);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      width: 260px;
      display: none;
    }

    .field-companion-widget.open .field-companion-panel {
      display: block;
    }

    .field-companion-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.6rem;
    }

    .field-companion-header-name {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .field-companion-header select {
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      font-size: 0.8rem;
    }

    .field-companion-body {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 0.6rem;
      align-items: center;
    }

    .field-companion-body img {
      width: 70px;
      height: 70px;
      border-radius: 18px;
      object-fit: cover;
      box-shadow: 0 8px 22px rgba(0, 0, 0, 0.7);
      border: 2px solid rgba(248, 250, 252, 0.85);
      background: #020617;
    }

    .field-companion-bars {
      display: grid;
      gap: 0.35rem;
    }

    .field-companion-bar-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.4rem;
    }

    .field-companion-bar-label {
      font-size: 0.75rem;
      min-width: 55px;
    }

    .pet-bar {
      flex: 1;
      height: 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.4);
      overflow: hidden;
    }

    .pet-bar-fill {
      height: 100%;
      width: 50%;
      border-radius: inherit;
      background: linear-gradient(90deg, #22c55e, #facc15);
      transition: width 0.2s ease-out;
    }

    .pet-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      margin-top: 0.5rem;
    }

    .pet-controls button {
      font-size: 0.75rem;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
    }

    .field-companion-status {
      margin-top: 0.4rem;
      font-size: 0.75rem;
      opacity: 0.9;
    }

    /* Hangman */
    .hangman-word {
      font-size: 1.5rem;
      letter-spacing: 0.2em;
      margin-bottom: 0.75rem;
      font-weight: 700;
    }

    .hangman-info {
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }

    .hangman-wrong {
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }

    .hangman-controls {
      margin-top: 0.8rem;
      display: flex;
      gap: 0.6rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .hangman-status {
      font-size: 0.9rem;
      margin-top: 0.4rem;
    }

    /* Stats & prompt */
    .stats-list {
      list-style: disc;
      padding-left: 1.2rem;
      margin: 0.4rem 0 0.75rem;
      font-size: 0.9rem;
    }

    .stats-list li {
      margin-bottom: 0.15rem;
    }

    .prompt-text {
      font-size: 0.95rem;
    }

    @media (max-width: 640px) {
      .game-card,
      .game-result-card {
        padding: 1.1rem 1.15rem;
      }

      .field-companion-panel {
        width: 240px;
      }
    }
  </style>
</head>
<body class="games-page">
  <header class="site-header">
    <div class="inner">
      <a href="index.html#hero" class="brand">
        <span class="brand-mark brand-mark-logo">
          <img src="logo-1.png" alt="SMCM MSL logo" />
        </span>
        <span class="brand-text">
          <span class="brand-title">Maryland Student Legislature</span>
          <span class="brand-sub">St. Mary‚Äôs College of Maryland Chapter</span>
        </span>
      </a>
      <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">‚ò∞</button>
      <nav class="nav" id="mainNav">
        <a href="index.html#hero">Home</a>
        <a href="index.html#maryland">About MSL</a>
        <a href="index.html#chapter">Our Chapter</a>
        <a href="executive-board.html">Exec Board</a>
        <a href="index.html#journey">Your Journey</a>
        <a href="index.html#documents">Documents</a>
        <a href="resources.html">Resources</a>
        <a href="bulletin.html">Bulletin</a>
        <a href="msl-game.html">Game</a>
        <a href="msl-giving.html">GIVING TUESDAY CHAMPIONSHIP</a>
        <a href="index.html#gallery">Gallery</a>
        <a href="index.html#contact">Join Us</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- GAME 1: PARLIAMENTARY PRO QUIZ -->
    <section class="section">
      <div class="inner game-wrapper">
        <div class="section-header center">
          <p class="eyebrow">Practice the Rules Before You Hit the Floor</p>
          <h1>Parliamentary Pro Lightning Round</h1>
          <p class="section-body">
            Test your knowledge of motions, floor procedure, and session vibes in a quick-fire quiz.
            Great for new delegates, petty bragging rights for veterans.
          </p>
        </div>

        <div class="card game-card" id="gameCard" data-game="quiz">
          <div class="game-meta">
            <span id="gameStatus">Question 1</span>
            <span id="gameScore">Score: 0</span>
          </div>
          <div class="game-question" id="gameQuestion">
            Loading question‚Ä¶
          </div>
          <div class="game-choices" id="gameChoices">
            <!-- buttons injected by JS -->
          </div>
          <div class="game-feedback" id="gameFeedback"></div>
          <div class="game-controls">
            <button id="nextBtn" class="btn btn-primary btn-ghost-small" disabled>
              Next question ‚Üí
            </button>
            <button id="restartBtn" class="btn btn-ghost btn-ghost-small" style="display:none;">
              Play again
            </button>
            <span class="game-progress" id="gameProgress"></span>
          </div>
        </div>

        <div id="gameResult" class="game-result-card" style="display:none;">
          <div class="game-result-score" id="resultScore"></div>
          <div class="game-result-sub" id="resultMessage"></div>
          <p class="game-tagline">
            Want to put this to use? Grab a bill idea, hit a workshop, and try this again after session.
          </p>

          <!-- Secret reward: all correct -->
          <div id="easterAllCorrect" class="game-easter-egg" style="display:none;">
            <strong>Perfect run.</strong> You unlocked the secret link ‚Äî clearly you read the rules.
            <br />
            üëâ <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank">Click for your ‚Äútotally serious‚Äù reward</a>
            <br />
            <span style="font-size:0.8rem; opacity:0.8;">
              (Coming Soon)
            </span>
          </div>

          <!-- Secret reward: zero correct -->
          <div id="easterAllWrong" class="game-easter-egg" style="display:none;">
            <strong>0/?? is a talent in itself.</strong> You also unlocked a secret link. Time to study‚Ä¶ or double down.
            <br />
            üëâ <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank">Consolation ‚Äútraining montage‚Äù</a>
          </div>

          <button id="resultRestartBtn" class="btn btn-primary btn-ghost-small" style="margin-top:0.75rem;">
            Run the lightning round again
          </button>
        </div>
      </div>
    </section>

    <!-- GAME 2: BILL CONCEPT LAB -->
    <section class="section bg-alt">
      <div class="inner game-wrapper">
        <div class="section-header center">
          <p class="eyebrow">Turn Vibes Into Draft Ideas</p>
          <h2>Bill Concept Lab</h2>
          <p class="section-body">
            Not sure what to write your first bill on? Answer a few quick questions and we‚Äôll spit out
            a rough bill concept you can refine with the Drafting Manual and your Exec Board.
          </p>
        </div>

        <div class="card game-card" id="billLabCard">
          <form id="billLabForm" class="bill-lab-form">
            <div>
              <label for="policyArea">What policy area are you drawn to?</label>
              <select id="policyArea" required>
                <option value="">Select a policy area‚Ä¶</option>
                <option value="environmental protection">Environment & Chesapeake Bay</option>
                <option value="education policy">Education & Higher Ed</option>
                <option value="public transportation and infrastructure">Transportation & Infrastructure</option>
                <option value="civil rights and liberties">Civil Rights & Civil Liberties</option>
                <option value="public health and safety">Public Health & Safety</option>
                <option value="housing and economic opportunity">Housing & Economic Opportunity</option>
              </select>
            </div>

            <div>
              <label for="changeLevel">What scale of change are you thinking?</label>
              <select id="changeLevel" required>
                <option value="">Choose one‚Ä¶</option>
                <option value="a targeted fix to an existing statute">Small, precise fix</option>
                <option value="a major reform to current practice">Major reform</option>
                <option value="a pilot program to test a new idea">Pilot program</option>
                <option value="a resolution to send a strong message">Symbolic resolution</option>
              </select>
            </div>

            <div>
              <label for="impactType">What kind of impact do you want?</label>
              <select id="impactType" required>
                <option value="">Pick your impact‚Ä¶</option>
                <option value="direct services or aid to Maryland residents">Direct aid / services</option>
                <option value="new standards or regulations for agencies or businesses">Regulation / standards</option>
                <option value="financial incentives or grants for local actors">Incentives / grants</option>
                <option value="statewide awareness, education, or data collection">Awareness / data</option>
              </select>
            </div>

            <div>
              <label for="issueText">What specific Maryland issue or community are you thinking about? (optional but powerful)</label>
              <textarea
                id="issueText"
                rows="3"
                placeholder="Example: runoff into the St. Mary‚Äôs River, broadband access in rural counties, transportation for community college students‚Ä¶"
              ></textarea>
            </div>

            <button type="submit" class="btn btn-primary btn-ghost-small">
              Generate Bill Concept
            </button>
          </form>

          <div id="billLabOutput" class="bill-lab-output" style="display:none;">
            <div class="bill-lab-meta" id="billLabMeta"></div>
            <h3 id="billLabTitle"></h3>
            <p id="billLabSummary"></p>
            <p class="small" style="margin-top:0.7rem;">
              Next steps: check the <a href="Legislative-Drafting-Manual.pdf" target="_blank">Drafting Manual (PDF)</a>,
              talk to the Exec Board, and refine this into real bill sections.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- ARCADE CORNER -->
    <section class="section bg-alt">
      <div class="inner game-wrapper">
        <div class="section-header center">
          <p class="eyebrow">Brain Off, Reflexes On</p>
          <h2>Arcade Corner</h2>
          <p class="section-body">
            Take a break with some low-stakes mini games. Scores here still count toward unlocking a secret page. (WIP)
            Click a game‚Äôs card to focus its controls.
          </p>
        </div>

        <!-- Snake -->
        <div class="card game-card" id="snakeGameCard" data-game="snake">
          <h3>MSL Snake: Rival on the Floor</h3>
          <p class="arcade-note">
            Click this card, then use <strong>W A S D</strong> to move. Eat the snacks, avoid the walls, your own tail,
            and the <strong>rival snake</strong> that chases the same food.
          </p>
          <canvas id="snakeCanvas" width="320" height="320"></canvas>
          <div class="game-meta">
            <span id="snakeScoreLabel">Score: 0</span>
            <span id="snakeBestLabel">Best: 0</span>
          </div>
          <p class="small" id="snakeStatus">Click this card, then press W, A, S, or D to start.</p>
        </div>

        <!-- Runner -->
        <div class="card game-card" id="runnerGameCard" data-game="runner" style="margin-top:1.5rem;">
          <h3>Runner on the Floor</h3>
          <p class="arcade-note">
            Click this card, then press space or ‚Üë to jump over triangular obstacles and gaps. Hit special blocks to spawn a
            flower that chases you , touch it for a temporary speed & jump boost.
          </p>
          <canvas id="runnerCanvas" width="400" height="200"></canvas>
          <div class="game-meta">
            <span id="runnerScoreLabel">Score: 0</span>
            <span id="runnerBestLabel">Best: 0</span>
          </div>
          <p class="small" id="runnerStatus">Click this card, then press space or ‚Üë to start running.</p>
        </div>

        <!-- Secret unlock card -->
        <div class="game-result-card" id="secretUnlockCard" style="display:none; margin-top:1.5rem;">
          <div class="game-result-score">Secret unlocked.</div>
          <div class="game-result-sub">
            You‚Äôve hit the quiz threshold, used the Bill Concept Lab, and scored in both arcade games.
          </div>
          <p class="game-tagline">
            Hidden page access:
            <a href="secret.html" id="secretLink">Open secret page</a><br />
            (Change this URL or page name to whatever you want for your ‚Äúreal‚Äù reward.)
          </p>
        </div>
      </div>
    </section>

    <!-- HANGMAN -->
    <section class="section">
      <div class="inner game-wrapper">
        <div class="section-header center">
          <p class="eyebrow">Words from the Chamber</p>
          <h2>MSL Hangman</h2>
          <p class="section-body">
            Click the card, then use your keyboard to guess letters. Terms are pulled from this site and our legislative world.
          </p>
        </div>

        <div class="card game-card" id="hangmanCard" data-game="hangman">
          <div class="hangman-word" id="hangmanWord">_ _ _ _ _</div>
          <div class="hangman-info">
            Wrong guesses: <span id="hangmanWrongCount">0</span> / <span id="hangmanMax">7</span>
          </div>
          <div class="hangman-wrong">
            Letters used: <span id="hangmanWrongLetters">‚Äî</span>
          </div>
          <div class="hangman-controls">
            <button type="button" class="btn btn-primary btn-ghost-small" id="hangmanNewBtn">New word</button>
            <span class="small">Click this card, then type A‚ÄìZ to guess.</span>
          </div>
          <div class="hangman-status small" id="hangmanStatus"></div>
        </div>
      </div>
    </section>

    <!-- STATS & PRACTICE PROMPTS -->
    <section class="section bg-alt">
      <div class="inner game-wrapper">
        <div class="section-header center">
          <p class="eyebrow">Level Up Between Sessions</p>
          <h2>Arcade Stats & Practice Prompts</h2>
          <p class="section-body">
            Track your arcade wins and pull quick prompts or concepts to practice before real MSL business.
          </p>
        </div>

        <div class="grid-2">
          <div class="card game-card" id="statsCard">
            <h3>Your Arcade Snapshot</h3>
            <ul class="stats-list">
              <li id="statsQuizBest">Best quiz score: ‚Äî</li>
              <li id="statsSnakeBest">Best Snake score: ‚Äî</li>
              <li id="statsRunnerBest">Best Runner score: ‚Äî</li>
              <li id="statsHangmanWins">Hangman words solved: ‚Äî</li>
            </ul>
            <button type="button" class="btn btn-ghost btn-ghost-small" id="statsResetBtn">
              Reset arcade stats
            </button>
            <p class="small" style="margin-top:0.5rem;">
              Stats live only in your browser ‚Äì clearing site data will wipe them.
            </p>
          </div>

          <div class="card game-card" id="promptCard">
            <h3>Practice Prompt Generator</h3>
            <p class="small">
              Use these for 60-second speeches, sponsor intros, or improv practice before session.
            </p>
            <p class="prompt-text" id="promptText" style="margin-top:0.75rem;"></p>
            <button type="button" class="btn btn-primary btn-ghost-small" id="promptNewBtn" style="margin-top:0.5rem;">
              New prompt
            </button>
            <div class="rule-of-visit" style="margin-top:0.9rem; border-top:1px solid rgba(148,163,184,0.6); padding-top:0.7rem;">
              <p class="small" id="ruleText"></p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- FIELD COMPANION WIDGET -->
  <div class="field-companion-widget" id="fieldCompanionWidget">
    <button class="field-companion-toggle" id="fieldCompanionToggle">
      üêæ Field Companion
      <span>click to open</span>
    </button>
    <div class="field-companion-panel" id="fieldCompanionPanel">
      <div class="field-companion-header">
        <span class="field-companion-header-name" id="petNameLabel">Delegate Dog</span>
        <select id="petType">
          <option value="dog">Dog</option>
          <option value="cat">Cat</option>
          <option value="koala">Koala</option>
        </select>
      </div>
      <div class="field-companion-body">
        <img id="petImage" src="pet-dog.gif" alt="Field companion" />
        <div>
          <div class="field-companion-bars">
            <div class="field-companion-bar-row">
              <span class="field-companion-bar-label">Hunger</span>
              <div class="pet-bar"><div class="pet-bar-fill" id="petHungerBar"></div></div>
            </div>
            <div class="field-companion-bar-row">
              <span class="field-companion-bar-label">Happiness</span>
              <div class="pet-bar"><div class="pet-bar-fill" id="petHappyBar"></div></div>
            </div>
            <div class="field-companion-bar-row">
              <span class="field-companion-bar-label">Energy</span>
              <div class="pet-bar"><div class="pet-bar-fill" id="petEnergyBar"></div></div>
            </div>
          </div>
          <div class="pet-controls">
            <button type="button" class="btn btn-primary btn-ghost-small" id="petFeedBtn">Feed</button>
            <button type="button" class="btn btn-ghost btn-ghost-small" id="petPlayBtn">Play</button>
            <button type="button" class="btn btn-ghost btn-ghost-small" id="petRestBtn">Rest</button>
          </div>
          <p class="field-companion-status" id="petStatus"></p>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="inner footer-inner">
      <p>¬© <span id="year"></span> Maryland Student Legislature ‚Äì St. Mary‚Äôs College of Maryland Chapter.</p>
      <p class="small">
        Student-led, nonpartisan, and rooted in Maryland‚Äôs civic life. This site is maintained by the SMCM
        Maryland Student Legislature Chapter and is not an official publication of St. Mary‚Äôs College of
        Maryland or the State of Maryland.
      </p>
    </div>
  </footer>

  <script src="script.js"></script>

  <!-- Mini-game logic -->
  <script>
    // ---------- ACHIEVEMENT TRACKING / SECRET PAGE ----------
    const QUIZ_TARGET = 6;
    const SNAKE_TARGET = 5;
    const RUNNER_TARGET = 150;
    const STORAGE_KEY = "mslArcadeProgress";

    const secretUnlockCard = document.getElementById("secretUnlockCard");

    // Game focus: only the focused game listens to keyboard
    let currentGameFocus = null;

    function setGameFocus(name) {
      currentGameFocus = name;
    }

    // Attach focus handlers to cards
    const focusCards = document.querySelectorAll("[data-game]");
    focusCards.forEach(card => {
      const gameName = card.getAttribute("data-game");
      card.addEventListener("click", () => {
        setGameFocus(gameName);
      });
    });

    const progress = loadProgress();

    function loadProgress() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) {
          return {
            quizThreshold: false,
            quizBest: 0,
            quizQuestions: 0,
            billLabUsed: false,
            snakeBest: 0,
            runnerBest: 0,
            hangmanWins: 0
          };
        }
        const parsed = JSON.parse(raw);
        return Object.assign(
          {
            quizThreshold: false,
            quizBest: 0,
            quizQuestions: 0,
            billLabUsed: false,
            snakeBest: 0,
            runnerBest: 0,
            hangmanWins: 0
          },
          parsed
        );
      } catch (e) {
        return {
          quizThreshold: false,
          quizBest: 0,
          quizQuestions: 0,
          billLabUsed: false,
          snakeBest: 0,
          runnerBest: 0,
          hangmanWins: 0
        };
      }
    }

    function saveProgress() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
      } catch (e) {
        // ignore
      }
    }

    function checkSecretUnlock() {
      if (
        progress.quizThreshold &&
        progress.billLabUsed &&
        progress.snakeBest >= SNAKE_TARGET &&
        progress.runnerBest >= RUNNER_TARGET
      ) {
        if (secretUnlockCard) {
          secretUnlockCard.style.display = "block";
        }
      }
    }

    checkSecretUnlock();

    // ---------- GAME 1: PARLIAMENTARY PRO QUIZ ----------
    const questions = [
      {
        question: "In a mock legislative session, what is the purpose of a motion for the Previous Question?",
        choices: [
          "To postpone a bill indefinitely",
          "To end debate and move immediately to a vote",
          "To send the bill back to committee",
          "To challenge the ruling of the chair"
        ],
        correctIndex: 1,
        explanation: "A motion for the Previous Question is used to close debate and move straight to a vote on the pending question."
      },
      {
        question: "You think the chair has misapplied a rule. What should you rise to?",
        choices: [
          "A point of personal privilege",
          "A point of order",
          "A motion to amend",
          "A motion to reconsider"
        ],
        correctIndex: 1,
        explanation: "A Point of Order is used to question whether proper procedure is being followed."
      },
      {
        question: "Which of the following is the BEST opening line for a sponsor speech in MSL?",
        choices: [
          "'So yeah, this bill is kind of self-explanatory.'",
          "'Members of the chamber, this bill addresses a gap in Maryland's current policy on‚Ä¶'",
          "'I'm not really sure why I'm sponsoring this, but here we go.'",
          "'I promise this will be quick, so please don't vote it down.'"
        ],
        correctIndex: 1,
        explanation: "Framing the issue clearly and in a Maryland context is the strongest way to start a sponsor speech."
      },
      {
        question: "A delegate wants to change a single line in your bill without rewriting the whole thing. What should they use?",
        choices: [
          "Motion to table",
          "Friendly amendment or amendment from the floor",
          "Motion to adjourn",
          "Appeal from the decision of the chair"
        ],
        correctIndex: 1,
        explanation: "Amendments‚Äîfriendly or from the floor‚Äîare how members change specific language in a bill."
      },
      {
        question: "In committee, which of these behaviors is the MOST helpful to moving business forward?",
        choices: [
          "Repeating the same point in every speech to 'drive it home'",
          "Listening for new information and building on or responding to it",
          "Talking over the chair to speed up debate",
          "Only speaking when you completely agree with the sponsor"
        ],
        correctIndex: 1,
        explanation: "Good committee work builds on what others say, responds to concerns, and helps refine the bill."
      },
      {
        question: "You need a short break to caucus or grab water without ending the meeting. What motion is most appropriate?",
        choices: [
          "Motion to recess",
          "Motion to adjourn",
          "Motion to lay on the table",
          "Motion to postpone indefinitely"
        ],
        correctIndex: 0,
        explanation: "A motion to recess allows a temporary break while keeping the meeting technically in session."
      },
      {
        question: "Why does MSL care so much about using Maryland-specific issues and law?",
        choices: [
          "Because national politics are banned in the chamber",
          "Because it‚Äôs fun to memorize obscure state code sections for no reason",
          "Because MSL simulates the Maryland General Assembly, where state-level issues and statutes matter most",
          "Because it makes writing bills easier than doing campus policy"
        ],
        correctIndex: 2,
        explanation: "MSL is modeled on the Maryland General Assembly, so centering state issues keeps the simulation realistic and useful."
      },
      {
        question: "You‚Äôre not recognized but you shout from the gallery anyway. What‚Äôs the likely outcome?",
        choices: [
          "You automatically win Debater of the Year",
          "The chair ignores you or gavels you out of order",
          "Your comment is added to the bill text",
          "The chamber pauses to debate your interruption"
        ],
        correctIndex: 1,
        explanation: "Speaking without recognition is out of order; good floor work relies on being recognized by the chair."
      }
    ];

    let currentIndex = 0;
    let score = 0;
    let hasAnswered = false;

    const questionEl = document.getElementById("gameQuestion");
    const choicesEl = document.getElementById("gameChoices");
    const feedbackEl = document.getElementById("gameFeedback");
    const statusEl = document.getElementById("gameStatus");
    const scoreEl = document.getElementById("gameScore");
    const progressEl = document.getElementById("gameProgress");
    const nextBtn = document.getElementById("nextBtn");
    const restartBtn = document.getElementById("restartBtn");
    const resultRestartBtn = document.getElementById("resultRestartBtn");
    const resultCard = document.getElementById("gameResult");
    const resultScore = document.getElementById("resultScore");
    const resultMessage = document.getElementById("resultMessage");
    const easterAllCorrect = document.getElementById("easterAllCorrect");
    const easterAllWrong = document.getElementById("easterAllWrong");

    function renderQuestion() {
      const q = questions[currentIndex];
      hasAnswered = false;

      statusEl.textContent = "Question " + (currentIndex + 1);
      scoreEl.textContent = "Score: " + score;
      progressEl.textContent = (currentIndex + 1) + " of " + questions.length;
      questionEl.textContent = q.question;
      feedbackEl.textContent = "";
      nextBtn.textContent = currentIndex === questions.length - 1 ? "See results ‚Üí" : "Next question ‚Üí";
      nextBtn.disabled = true;
      restartBtn.style.display = "none";

      choicesEl.innerHTML = "";

      q.choices.forEach(function (choiceText, idx) {
        const btn = document.createElement("button");
        btn.className = "game-choice-btn";
        btn.textContent = choiceText;
        btn.addEventListener("click", function () {
          handleChoice(idx);
        });
        choicesEl.appendChild(btn);
      });
    }

    function handleChoice(selectedIndex) {
      if (hasAnswered) return;
      hasAnswered = true;

      const q = questions[currentIndex];
      const buttons = Array.prototype.slice.call(document.querySelectorAll(".game-choice-btn"));

      buttons.forEach(function (btn, idx) {
        btn.disabled = true;
        if (idx === q.correctIndex) {
          btn.classList.add("correct");
        }
        if (idx === selectedIndex && idx !== q.correctIndex) {
          btn.classList.add("incorrect");
        }
      });

      if (selectedIndex === q.correctIndex) {
        score++;
        feedbackEl.innerHTML = "<strong>Correct!</strong> " + q.explanation;
      } else {
        feedbackEl.innerHTML = "<strong>Not quite.</strong> " + q.explanation;
      }

      scoreEl.textContent = "Score: " + score;
      nextBtn.disabled = false;
    }

    function showResults() {
      const total = questions.length;
      const percent = Math.round((score / total) * 100);
      resultScore.textContent = "You scored " + score + " out of " + total + " (" + percent + "%).";

      let msg;
      if (percent >= 85) {
        msg = "You‚Äôre chamber-ready. Grab a bill and go bully the mic (respectfully).";
      } else if (percent >= 60) {
        msg = "Solid foundation. A couple more sessions and you‚Äôll be running committee.";
      } else {
        msg = "Good start. Pair this with a workshop and one real session and you‚Äôll level up fast.";
      }

      resultMessage.textContent = msg;

      easterAllCorrect.style.display = "none";
      easterAllWrong.style.display = "none";

      if (score === total) {
        easterAllCorrect.style.display = "block";
      } else if (score === 0) {
        easterAllWrong.style.display = "block";
      }

      // Track best quiz score and threshold
      if (score >= QUIZ_TARGET) {
        progress.quizThreshold = true;
      }
      if (score > (progress.quizBest || 0)) {
        progress.quizBest = score;
      }
      progress.quizQuestions = questions.length;
      saveProgress();
      checkSecretUnlock();
      updateStatsUI();

      resultCard.style.display = "block";
      restartBtn.style.display = "inline-flex";
    }

    function nextQuestion() {
      if (currentIndex < questions.length - 1) {
        currentIndex++;
        renderQuestion();
      } else {
        showResults();
      }
    }

    function restartGame() {
      currentIndex = 0;
      score = 0;
      resultCard.style.display = "none";
      renderQuestion();
    }

    if (nextBtn) nextBtn.addEventListener("click", nextQuestion);
    if (restartBtn) restartBtn.addEventListener("click", restartGame);
    if (resultRestartBtn) resultRestartBtn.addEventListener("click", restartGame);

    renderQuestion();

    // ---------- GAME 2: BILL CONCEPT LAB ----------
    const billLabForm = document.getElementById("billLabForm");
    const policyAreaEl = document.getElementById("policyArea");
    const changeLevelEl = document.getElementById("changeLevel");
    const impactTypeEl = document.getElementById("impactType");
    const issueTextEl = document.getElementById("issueText");
    const billLabOutput = document.getElementById("billLabOutput");
    const billLabMeta = document.getElementById("billLabMeta");
    const billLabTitle = document.getElementById("billLabTitle");
    const billLabSummary = document.getElementById("billLabSummary");

    if (billLabForm) {
      billLabForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const area = policyAreaEl.value;
        const change = changeLevelEl.value;
        const impact = impactTypeEl.value;
        const issueRaw = issueTextEl.value.trim();

        if (!area || !change || !impact) {
          return;
        }

        const issue = issueRaw || "a priority identified by SMCM delegates and Maryland students";
        const title = "An Act Concerning " + capitalizeFirst(area) + " and " + shortenIssue(issue);
        const meta = "Draft concept ‚Ä¢ " + capitalizeFirst(area) + " ‚Ä¢ " + change;
        const summary =
          "This bill would address " + issue +
          " by pursuing " + change +
          " in the area of " + area +
          ", using a framework centered on " + impact +
          ".\n\n" +
          "Key pieces to develop:\n" +
          "‚Ä¢ A clear findings section explaining why this issue matters in Maryland.\n" +
          "‚Ä¢ Definitions for any technical terms or agencies mentioned.\n" +
          "‚Ä¢ Specific sections describing what the state, local governments, or partners must do.\n" +
          "‚Ä¢ An effective date and, if needed, a sunset or reporting requirement.";

        billLabMeta.textContent = meta;
        billLabTitle.textContent = title;
        billLabSummary.textContent = summary;
        billLabOutput.style.display = "block";

        progress.billLabUsed = true;
        saveProgress();
        checkSecretUnlock();
      });
    }

    function capitalizeFirst(text) {
      if (!text) return "";
      return text.charAt(0).toUpperCase() + text.slice(1);
    }

    function shortenIssue(issue) {
      const max = 60;
      if (issue.length <= max) return issue;
      return issue.slice(0, max).trim() + "‚Ä¶";
    }

    // ---------- GAME 3: SNAKE WITH RIVAL (WASD ONLY) ----------
    const snakeCanvas = document.getElementById("snakeCanvas");
    const snakeScoreLabel = document.getElementById("snakeScoreLabel");
    const snakeBestLabel = document.getElementById("snakeBestLabel");
    const snakeStatus = document.getElementById("snakeStatus");

    let snakeCtx = null;
    let snake = [];
    let snakeDir = { x: 1, y: 0 };
    let snakeNextDir = { x: 1, y: 0 };
    let snakeFood = { x: 10, y: 10 };
    let snakeScore = 0;
    let snakeBest = progress.snakeBest || 0;
    let snakeInterval = null;
    const snakeGridSize = 16;

    // Rival snake
    let rival = [];
    let rivalLength = 4;

    if (snakeBestLabel) {
      snakeBestLabel.textContent = "Best: " + snakeBest;
    }

    function snakeInit() {
      if (!snakeCanvas) return;
      snakeCtx = snakeCanvas.getContext("2d");
      resetSnake();
      document.addEventListener("keydown", snakeKeyHandler);
    }

    function resetSnake() {
      const cols = Math.floor(snakeCanvas.width / snakeGridSize);
      const rows = Math.floor(snakeCanvas.height / snakeGridSize);

      snake = [{ x: Math.floor(cols / 2), y: Math.floor(rows / 2) }];
      snakeDir = { x: 1, y: 0 };
      snakeNextDir = { x: 1, y: 0 };
      snakeScore = 0;
      updateSnakeScore();

      // Rival starting position
      rival = [];
      const rx = Math.floor(cols / 4);
      const ry = Math.floor(rows / 4);
      for (let i = 0; i < rivalLength; i++) {
        rival.push({ x: rx - i, y: ry });
      }

      placeSnakeFood();
      drawSnake();

      if (snakeStatus) snakeStatus.textContent = "Click the card, then press W, A, S, or D to start.";
      if (snakeInterval) {
        clearInterval(snakeInterval);
        snakeInterval = null;
      }
    }

    function placeSnakeFood() {
      const cols = Math.floor(snakeCanvas.width / snakeGridSize);
      const rows = Math.floor(snakeCanvas.height / snakeGridSize);
      let fx, fy, safe = false;

      while (!safe) {
        fx = Math.floor(Math.random() * cols);
        fy = Math.floor(Math.random() * rows);
        safe = true;

        // Avoid placing directly on snake or rival segments
        for (let i = 0; i < snake.length; i++) {
          if (snake[i].x === fx && snake[i].y === fy) {
            safe = false;
            break;
          }
        }
        for (let j = 0; j < rival.length && safe; j++) {
          if (rival[j].x === fx && rival[j].y === fy) {
            safe = false;
            break;
          }
        }
      }

      snakeFood.x = fx;
      snakeFood.y = fy;
    }

    function snakeKeyHandler(e) {
      if (currentGameFocus !== "snake") return;

      const key = e.key;
      if (key === "w" || key === "W") {
        if (snakeDir.y === 1) return;
        snakeNextDir = { x: 0, y: -1 };
      } else if (key === "s" || key === "S") {
        if (snakeDir.y === -1) return;
        snakeNextDir = { x: 0, y: 1 };
      } else if (key === "a" || key === "A") {
        if (snakeDir.x === 1) return;
        snakeNextDir = { x: -1, y: 0 };
      } else if (key === "d" || key === "D") {
        if (snakeDir.x === -1) return;
        snakeNextDir = { x: 1, y: 0 };
      } else {
        return;
      }

      if (!snakeInterval) {
        if (snakeStatus) snakeStatus.textContent = "Game on. Rival is hungry too.";
        snakeInterval = setInterval(snakeTick, 110);
      }
    }

    function snakeTick() {
      if (!snakeCtx) return;

      snakeDir = snakeNextDir;
      const cols = Math.floor(snakeCanvas.width / snakeGridSize);
      const rows = Math.floor(snakeCanvas.height / snakeGridSize);

      // Player head
      const head = { x: snake[0].x + snakeDir.x, y: snake[0].y + snakeDir.y };

      // wall collision
      if (head.x < 0 || head.y < 0 || head.x >= cols || head.y >= rows) {
        snakeGameOver("You hit the wall.");
        return;
      }

      // self collision
      for (let i = 0; i < snake.length; i++) {
        if (snake[i].x === head.x && snake[i].y === head.y) {
          snakeGameOver("You ran into yourself.");
          return;
        }
      }

      // collision with rival body
      for (let i = 0; i < rival.length; i++) {
        if (rival[i].x === head.x && rival[i].y === head.y) {
          snakeGameOver("You collided with the rival snake.");
          return;
        }
      }

      snake.unshift(head);

      if (head.x === snakeFood.x && head.y === snakeFood.y) {
        snakeScore++;
        updateSnakeScore();
        placeSnakeFood();
      } else {
        snake.pop();
      }

      // Rival movement towards food
      moveRival(cols, rows);

      // Rival eats food?
      const rivalHead = rival[0];
      if (rivalHead.x === snakeFood.x && rivalHead.y === snakeFood.y) {
        if (snakeStatus) snakeStatus.textContent = "Rival stole the snack! New target‚Ä¶";
        placeSnakeFood();
      }

      // Rival collides with player head/body after moving
      for (let i = 0; i < rival.length; i++) {
        if (rival[i].x === head.x && rival[i].y === head.y) {
          snakeGameOver("You collided with the rival snake.");
          return;
        }
      }

      drawSnake();
    }

    function moveRival(cols, rows) {
      if (!rival.length) return;

      const head = { x: rival[0].x, y: rival[0].y };

      // Simple chase AI: prioritize horizontal, then vertical
      let dx = 0;
      let dy = 0;
      if (head.x < snakeFood.x) dx = 1;
      else if (head.x > snakeFood.x) dx = -1;
      else if (head.y < snakeFood.y) dy = 1;
      else if (head.y > snakeFood.y) dy = -1;

      const newHead = { x: head.x + dx, y: head.y + dy };

      if (newHead.x < 0 || newHead.y < 0 || newHead.x >= cols || newHead.y >= rows) {
        return;
      }

      rival.unshift(newHead);
      while (rival.length > rivalLength) {
        rival.pop();
      }
    }

    function drawSnake() {
      snakeCtx.clearRect(0, 0, snakeCanvas.width, snakeCanvas.height);

      // food
      snakeCtx.fillStyle = "#facc15";
      snakeCtx.fillRect(
        snakeFood.x * snakeGridSize,
        snakeFood.y * snakeGridSize,
        snakeGridSize,
        snakeGridSize
      );

      // player snake
      snakeCtx.fillStyle = "#22c55e";
      snake.forEach(function (seg) {
        snakeCtx.fillRect(
          seg.x * snakeGridSize,
          seg.y * snakeGridSize,
          snakeGridSize - 1,
          snakeGridSize - 1
        );
      });

      // rival snake
      snakeCtx.fillStyle = "#ef4444";
      rival.forEach(function (seg) {
        snakeCtx.fillRect(
          seg.x * snakeGridSize,
          seg.y * snakeGridSize,
          snakeGridSize - 1,
          snakeGridSize - 1
        );
      });
    }

    function updateSnakeScore() {
      if (snakeScoreLabel) snakeScoreLabel.textContent = "Score: " + snakeScore;
      if (snakeScore > snakeBest) {
        snakeBest = snakeScore;
        if (snakeBestLabel) snakeBestLabel.textContent = "Best: " + snakeBest;
        progress.snakeBest = snakeBest;
        saveProgress();
        checkSecretUnlock();
        updateStatsUI();
      }
    }

    function snakeGameOver(msg) {
      if (snakeStatus) snakeStatus.textContent = "Game over. " + msg + " Click the card, then press W, A, S, or D to restart.";
      clearInterval(snakeInterval);
      snakeInterval = null;
      setTimeout(resetSnake, 500);
    }

    if (snakeCanvas) {
      snakeInit();
    }

    // ---------- GAME 4: RUNNER ----------
    const runnerCanvas = document.getElementById("runnerCanvas");
    const runnerScoreLabel = document.getElementById("runnerScoreLabel");
    const runnerBestLabel = document.getElementById("runnerBestLabel");
    const runnerStatus = document.getElementById("runnerStatus");

    let runnerCtx = null;
    let runnerAnimId = null;
    let runnerRunning = false;
    let runnerScore = 0;
    let runnerBest = progress.runnerBest || 0;

    let player = {
      x: 40,
      y: 0,
      width: 26,
      height: 38,
      vy: 0,
      onGround: false
    };

    const baseGravity = 0.8;
    const baseJumpVelocity = -12;
    const baseGroundY = 160;

    let gravity = baseGravity;
    let jumpVelocity = baseJumpVelocity;
    let groundY = baseGroundY;

    let obstacles = [];
    let obstacleTimer = 0;

    let gaps = [];
    let gapTimer = 0;

    let blocks = [];
    let blockTimer = 0;

    let flowers = [];
    let boostActive = false;
    let boostTimer = 0;
    const BOOST_DURATION_FRAMES = 60 * 5;

    if (runnerBestLabel) {
      runnerBestLabel.textContent = "Best: " + runnerBest;
    }

    function runnerInit() {
      if (!runnerCanvas) return;
      runnerCtx = runnerCanvas.getContext("2d");
      resetRunner();
      document.addEventListener("keydown", runnerKeyHandler);
    }

    function resetRunner() {
      player.y = groundY - player.height;
      player.vy = 0;
      player.onGround = true;
      runnerScore = 0;
      obstacles = [];
      obstacleTimer = 0;
      gaps = [];
      gapTimer = 0;
      blocks = [];
      blockTimer = 0;
      flowers = [];
      boostActive = false;
      boostTimer = 0;
      gravity = baseGravity;
      jumpVelocity = baseJumpVelocity;

      updateRunnerScore();
      if (runnerStatus) runnerStatus.textContent = "Click the card, then press space or ‚Üë to start running.";
      if (runnerAnimId) {
        cancelAnimationFrame(runnerAnimId);
        runnerAnimId = null;
      }
      drawRunnerFrame();
      runnerRunning = false;
    }

    function runnerKeyHandler(e) {
      if (currentGameFocus !== "runner") return;

      if (e.key === " " || e.key === "ArrowUp") {
        e.preventDefault();
        if (!runnerRunning) {
          runnerRunning = true;
          if (runnerStatus) runnerStatus.textContent = "Stay alive. Jump gaps and obstacles, grab boosts.";
          runnerAnimId = requestAnimationFrame(runnerLoop);
        }
        if (player.onGround) {
          player.vy = jumpVelocity;
          player.onGround = false;
        }
      }
    }

    function runnerLoop() {
      updateRunner();
      drawRunnerFrame();
      if (runnerRunning) {
        runnerAnimId = requestAnimationFrame(runnerLoop);
      }
    }

    function updateRunner() {
      player.vy += gravity;
      player.y += player.vy;

      const playerCenterX = player.x + player.width / 2;
      const overSolidGround = !isOverGap(playerCenterX);

      if (overSolidGround && player.y >= groundY - player.height) {
        player.y = groundY - player.height;
        player.vy = 0;
        player.onGround = true;
      } else if (!overSolidGround && player.y > runnerCanvas.height) {
        runnerGameOver("You fell into a gap.");
        return;
      }

      obstacleTimer++;
      if (obstacleTimer > 60) {
        obstacleTimer = 0;
        obstacles.push({
          x: runnerCanvas.width + 10,
          y: groundY - 24,
          width: 20,
          height: 24,
          speed: boostActive ? 6 : 4
        });
      }

      gapTimer++;
      if (gapTimer > 160) {
        gapTimer = 0;
        const gapWidth = 60 + Math.random() * 40;
        gaps.push({
          x: runnerCanvas.width + 50,
          width: gapWidth,
          speed: 4
        });
      }

      blockTimer++;
      if (blockTimer > 220) {
        blockTimer = 0;
        blocks.push({
          x: runnerCanvas.width + 30,
          y: groundY - 40,
          width: 26,
          height: 26,
          speed: 4
        });
      }

      obstacles.forEach(function (ob) {
        ob.x -= boostActive ? 6 : 4;
      });
      gaps.forEach(function (g) {
        g.x -= 4;
      });
      blocks.forEach(function (b) {
        b.x -= 4;
      });
      flowers.forEach(function (f) {
        const targetX = playerCenterX + 20;
        if (f.x > targetX) f.x -= 3;
        else if (f.x < targetX) f.x += 2;

        const targetY = player.y;
        if (f.y > targetY - 20) f.y -= 1.5;
        else if (f.y < targetY - 20) f.y += 1.2;
      });

      obstacles = obstacles.filter(ob => ob.x + ob.width > -20);
      gaps = gaps.filter(g => g.x + g.width > -20);
      blocks = blocks.filter(b => b.x + b.width > -20);
      flowers = flowers.filter(f => f.x > -40 && f.x < runnerCanvas.width + 40);

      for (let i = 0; i < obstacles.length; i++) {
        const ob = obstacles[i];
        if (
          player.x < ob.x + ob.width &&
          player.x + player.width > ob.x &&
          player.y < ob.y + ob.height &&
          player.y + player.height > ob.y
        ) {
          runnerGameOver("You hit an obstacle.");
          return;
        }
      }

      for (let i = blocks.length - 1; i >= 0; i--) {
        const b = blocks[i];
        if (
          player.x < b.x + b.width &&
          player.x + player.width > b.x &&
          player.y < b.y + b.height &&
          player.y + player.height > b.y
        ) {
          flowers.push({
            x: b.x,
            y: b.y - 10
          });
          blocks.splice(i, 1);
          if (runnerStatus) runnerStatus.textContent = "Flower spawned ‚Äì let it catch you for a boost.";
        }
      }

      for (let i = flowers.length - 1; i >= 0; i--) {
        const f = flowers[i];
        if (
          player.x < f.x + 16 &&
          player.x + player.width > f.x - 16 &&
          player.y < f.y + 16 &&
          player.y + player.height > f.y - 16
        ) {
          flowers.splice(i, 1);
          activateBoost();
        }
      }

      if (boostActive) {
        boostTimer++;
        if (boostTimer > BOOST_DURATION_FRAMES) {
          boostActive = false;
          boostTimer = 0;
          gravity = baseGravity;
          jumpVelocity = baseJumpVelocity;
          if (runnerStatus) runnerStatus.textContent = "Boost ended. Back to normal speed.";
        }
      }

      runnerScore += 1;
      updateRunnerScore();
    }

    function isOverGap(x) {
      for (let i = 0; i < gaps.length; i++) {
        const g = gaps[i];
        if (x >= g.x && x <= g.x + g.width) {
          return true;
        }
      }
      return false;
    }

    function activateBoost() {
      boostActive = true;
      boostTimer = 0;
      gravity = baseGravity * 0.8;
      jumpVelocity = baseJumpVelocity * 1.15;
      if (runnerStatus) runnerStatus.textContent = "Boost active! Higher jumps & faster pace.";
    }

    function drawRunnerFrame() {
      if (!runnerCtx) return;
      runnerCtx.clearRect(0, 0, runnerCanvas.width, runnerCanvas.height);

      runnerCtx.fillStyle = "#1e293b";
      const groundHeight = 4;
      runnerCtx.fillRect(0, groundY, runnerCanvas.width, groundHeight);

      runnerCtx.fillStyle = "#020617";
      gaps.forEach(function (g) {
        runnerCtx.fillRect(g.x, groundY, g.width, groundHeight + 20);
      });

      runnerCtx.fillStyle = boostActive ? "#22c55e" : "#16a34a";
      runnerCtx.fillRect(player.x, player.y, player.width, player.height);

      runnerCtx.fillStyle = "#f97316";
      obstacles.forEach(function (ob) {
        runnerCtx.beginPath();
        runnerCtx.moveTo(ob.x, ob.y + ob.height);
        runnerCtx.lineTo(ob.x + ob.width / 2, ob.y);
        runnerCtx.lineTo(ob.x + ob.width, ob.y + ob.height);
        runnerCtx.closePath();
        runnerCtx.fill();
      });

      runnerCtx.fillStyle = "#facc15";
      blocks.forEach(function (b) {
        runnerCtx.fillRect(b.x, b.y, b.width, b.height);
      });

      runnerCtx.fillStyle = "#ea580c";
      flowers.forEach(function (f) {
        runnerCtx.beginPath();
        runnerCtx.arc(f.x, f.y, 10, 0, Math.PI * 2);
        runnerCtx.fill();
      });
    }

    function updateRunnerScore() {
      if (runnerScoreLabel) runnerScoreLabel.textContent = "Score: " + runnerScore;
      if (runnerScore > runnerBest) {
        runnerBest = runnerScore;
        if (runnerBestLabel) runnerBestLabel.textContent = "Best: " + runnerBest;
        progress.runnerBest = runnerBest;
        saveProgress();
        checkSecretUnlock();
        updateStatsUI();
      }
    }

    function runnerGameOver(reason) {
      runnerRunning = false;
      if (runnerStatus) runnerStatus.textContent = "You lost: " + reason + " Click the card, then press space or ‚Üë to try again.";
      setTimeout(resetRunner, 600);
    }

    if (runnerCanvas) {
      runnerInit();
    }

    // ---------- PET: FIELD COMPANION ----------
    const fieldCompanionWidget = document.getElementById("fieldCompanionWidget");
    const fieldCompanionToggle = document.getElementById("fieldCompanionToggle");

    if (fieldCompanionToggle && fieldCompanionWidget) {
      fieldCompanionToggle.addEventListener("click", () => {
        fieldCompanionWidget.classList.toggle("open");
      });
    }

    const petTypeEl = document.getElementById("petType");
    const petImageEl = document.getElementById("petImage");
    const petNameLabelEl = document.getElementById("petNameLabel");
    const petHungerBar = document.getElementById("petHungerBar");
    const petHappyBar = document.getElementById("petHappyBar");
    const petEnergyBar = document.getElementById("petEnergyBar");
    const petStatusEl = document.getElementById("petStatus");

    const petFeedBtn = document.getElementById("petFeedBtn");
    const petPlayBtn = document.getElementById("petPlayBtn");
    const petRestBtn = document.getElementById("petRestBtn");

    const PET_KEY = "mslPetState";

    let petState = loadPetState();

    function loadPetState() {
      try {
        const raw = localStorage.getItem(PET_KEY);
        if (!raw) {
          return {
            type: "dog",
            hunger: 70,
            happiness: 70,
            energy: 70
          };
        }
        const parsed = JSON.parse(raw);
        return Object.assign(
          {
            type: "dog",
            hunger: 70,
            happiness: 70,
            energy: 70
          },
          parsed
        );
      } catch (e) {
        return {
          type: "dog",
          hunger: 70,
          happiness: 70,
          energy: 70
        };
      }
    }

    function savePetState() {
      try {
        localStorage.setItem(PET_KEY, JSON.stringify(petState));
      } catch (e) {
        // ignore
      }
    }

    function getPetAsset(type) {
      if (type === "dog") return "pet-dog.gif";
      if (type === "cat") return "pet-cat.gif";
      if (type === "koala") return "pet-koala.gif";
      return "pet-dog.gif";
    }

    function getPetName(type) {
      if (type === "dog") return "Delegate Dog";
      if (type === "cat") return "Committee Cat";
      if (type === "koala") return "Caucus Koala";
      return "Field Friend";
    }

    function clampStat(v) {
      return Math.max(0, Math.min(100, v));
    }

    function updatePetUI(message) {
      if (petImageEl) {
        petImageEl.src = getPetAsset(petState.type);
      }
      if (petNameLabelEl) {
        petNameLabelEl.textContent = getPetName(petState.type);
      }

      if (petHungerBar) petHungerBar.style.width = petState.hunger + "%";
      if (petHappyBar) petHappyBar.style.width = petState.happiness + "%";
      if (petEnergyBar) petEnergyBar.style.width = petState.energy + "%";

      if (petStatusEl) {
        petStatusEl.textContent = message || "";
      }
    }

    if (petTypeEl) {
      petTypeEl.value = petState.type;
      petTypeEl.addEventListener("change", function () {
        petState.type = petTypeEl.value;
        savePetState();
        updatePetUI("You switched companions. Be kind to whoever‚Äôs on duty.");
      });
    }

    if (petFeedBtn) {
      petFeedBtn.addEventListener("click", function () {
        petState.hunger = clampStat(petState.hunger + 18);
        petState.energy = clampStat(petState.energy + 6);
        savePetState();
        updatePetUI("Snack delivered. Hunger improved.");
      });
    }

    if (petPlayBtn) {
      petPlayBtn.addEventListener("click", function () {
        petState.happiness = clampStat(petState.happiness + 15);
        petState.energy = clampStat(petState.energy - 8);
        petState.hunger = clampStat(petState.hunger - 5);
        savePetState();
        updatePetUI("Play session logged. Happiness up.");
      });
    }

    if (petRestBtn) {
      petRestBtn.addEventListener("click", function () {
        petState.energy = clampStat(petState.energy + 20);
        petState.hunger = clampStat(petState.hunger - 5);
        savePetState();
        updatePetUI("Short break taken. Energy restored.");
      });
    }

    setInterval(function () {
      petState.hunger = clampStat(petState.hunger - 2);
      petState.happiness = clampStat(petState.happiness - 1);
      petState.energy = clampStat(petState.energy - 1);
      savePetState();
      updatePetUI();
    }, 30000);

    updatePetUI();

    // ---------- HANGMAN ----------
    const hangmanWords = [
      "maryland",
      "delegate",
      "caucus",
      "bill",
      "session",
      "constitution",
      "bylaws",
      "democracy",
      "amendment",
      "parliamentary"
    ];

    const hangmanWordEl = document.getElementById("hangmanWord");
    const hangmanWrongCountEl = document.getElementById("hangmanWrongCount");
    const hangmanMaxEl = document.getElementById("hangmanMax");
    const hangmanWrongLettersEl = document.getElementById("hangmanWrongLetters");
    const hangmanStatusEl = document.getElementById("hangmanStatus");
    const hangmanNewBtn = document.getElementById("hangmanNewBtn");

    let hangmanCurrentWord = "";
    let hangmanRevealed = [];
    let hangmanWrongLetters = [];
    let hangmanWrongCount = 0;
    const HANGMAN_MAX = 7;
    let hangmanFinished = false;
    hangmanMaxEl.textContent = HANGMAN_MAX;

    function startHangman() {
      const idx = Math.floor(Math.random() * hangmanWords.length);
      hangmanCurrentWord = hangmanWords[idx];
      hangmanRevealed = Array(hangmanCurrentWord.length).fill(false);
      hangmanWrongLetters = [];
      hangmanWrongCount = 0;
      hangmanFinished = false;
      updateHangmanUI("New word loaded. Type letters to guess.");
    }

    function updateHangmanUI(message) {
      let displayWord = "";
      for (let i = 0; i < hangmanCurrentWord.length; i++) {
        displayWord += (hangmanRevealed[i] ? hangmanCurrentWord[i].toUpperCase() : "_") + " ";
      }
      hangmanWordEl.textContent = displayWord.trim();
      hangmanWrongCountEl.textContent = hangmanWrongCount;
      hangmanWrongLettersEl.textContent = hangmanWrongLetters.length
        ? hangmanWrongLetters.map(l => l.toUpperCase()).join(", ")
        : "‚Äî";
      hangmanStatusEl.textContent = message || "";

      const allRevealed = hangmanRevealed.every(v => v);
      if (allRevealed && !hangmanFinished) {
        hangmanFinished = true;
        hangmanStatusEl.textContent = "You got it. Very legislative of you.";
        progress.hangmanWins = (progress.hangmanWins || 0) + 1;
        saveProgress();
        updateStatsUI();
      } else if (hangmanWrongCount >= HANGMAN_MAX && !hangmanFinished) {
        hangmanFinished = true;
        hangmanStatusEl.textContent = "Out of guesses. The word was: " + hangmanCurrentWord.toUpperCase();
      }
    }

    function handleHangmanKey(key) {
      if (!hangmanCurrentWord) return;
      if (!/^[a-zA-Z]$/.test(key)) return;

      const letter = key.toLowerCase();
      const allRevealed = hangmanRevealed.every(v => v);
      if (allRevealed || hangmanWrongCount >= HANGMAN_MAX) {
        return;
      }

      if (hangmanRevealed.some((rev, idx) => rev && hangmanCurrentWord[idx] === letter)) {
        return;
      }
      if (hangmanWrongLetters.includes(letter)) {
        return;
      }

      let found = false;
      for (let i = 0; i < hangmanCurrentWord.length; i++) {
        if (hangmanCurrentWord[i] === letter) {
          hangmanRevealed[i] = true;
          found = true;
        }
      }

      if (!found) {
        hangmanWrongLetters.push(letter);
        hangmanWrongCount++;
        updateHangmanUI("Not in the word.");
      } else {
        updateHangmanUI("Nice pull.");
      }
    }

    if (hangmanNewBtn) {
      hangmanNewBtn.addEventListener("click", function () {
        startHangman();
      });
    }

    document.addEventListener("keydown", function (e) {
      if (currentGameFocus !== "hangman") return;
      if (e.key.length === 1 && /^[a-zA-Z]$/.test(e.key)) {
        handleHangmanKey(e.key);
      }
    });

    startHangman();

    // ---------- STATS & PROMPTS ----------
    const statsQuizBestEl = document.getElementById("statsQuizBest");
    const statsSnakeBestEl = document.getElementById("statsSnakeBest");
    const statsRunnerBestEl = document.getElementById("statsRunnerBest");
    const statsHangmanWinsEl = document.getElementById("statsHangmanWins");
    const statsResetBtn = document.getElementById("statsResetBtn");

    function updateStatsUI() {
      if (!statsQuizBestEl) return;
      const quizBest = progress.quizBest || 0;
      const quizTotal = progress.quizQuestions || questions.length;
      statsQuizBestEl.textContent = quizBest
        ? "Best quiz score: " + quizBest + " / " + quizTotal
        : "Best quiz score: ‚Äî";
      statsSnakeBestEl.textContent = "Best Snake score: " + (progress.snakeBest || 0);
      statsRunnerBestEl.textContent = "Best Runner score: " + (progress.runnerBest || 0);
      statsHangmanWinsEl.textContent = "Hangman words solved: " + (progress.hangmanWins || 0);
    }

    if (statsResetBtn) {
      statsResetBtn.addEventListener("click", function () {
        progress.quizThreshold = false;
        progress.quizBest = 0;
        progress.quizQuestions = questions.length;
        progress.billLabUsed = false;
        progress.snakeBest = 0;
        progress.runnerBest = 0;
        progress.hangmanWins = 0;
        saveProgress();
        updateStatsUI();
        if (secretUnlockCard) secretUnlockCard.style.display = "none";
      });
    }

    const practicePrompts = [
      "You are recognized for a 1-minute speech in favor of a bill expanding broadband access in rural Maryland counties.",
      "You are speaking against a bill that would cut funding for environmental restoration in the Chesapeake Bay watershed.",
      "You rise as the sponsor of a bill to improve campus mental health resources across Maryland public colleges.",
      "You are giving a closing speech on a resolution supporting student voter registration efforts in Maryland.",
      "You are recognized to oppose a bill that weakens tenant protections in student-heavy communities.",
      "You are the floor leader explaining a complex amendment that strengthens police accountability reporting.",
      "You are speaking in favor of a pilot program to provide free bus passes for community college students.",
      "You are introducing a resolution honoring local volunteers who responded to a recent climate-related disaster."
    ];

    const ruleSnippets = [
      {
        term: "Previous Question",
        text: "A motion used to end debate and move immediately to a vote on the pending question."
      },
      {
        term: "Point of Order",
        text: "A question raised to the chair about whether proper procedure is being followed."
      },
      {
        term: "Amendment",
        text: "A change proposed to a bill or resolution, often adding, striking, or substituting language."
      },
      {
        term: "Recess",
        text: "A short break in the meeting that pauses business without adjourning the session."
      },
      {
        term: "Caucus",
        text: "A group of members who meet to strategize, share information, or coordinate positions."
      }
    ];

    const promptTextEl = document.getElementById("promptText");
    const ruleTextEl = document.getElementById("ruleText");
    const promptNewBtn = document.getElementById("promptNewBtn");

    function generatePrompt() {
      if (!promptTextEl || !ruleTextEl) return;
      const p = practicePrompts[Math.floor(Math.random() * practicePrompts.length)];
      const r = ruleSnippets[Math.floor(Math.random() * ruleSnippets.length)];
      promptTextEl.textContent = p;
      ruleTextEl.textContent = r.term + ": " + r.text;
    }

    if (promptNewBtn) {
      promptNewBtn.addEventListener("click", generatePrompt);
    }

    // Initial stats & prompt
    updateStatsUI();
    generatePrompt();
  </script>
</body>
</html>
